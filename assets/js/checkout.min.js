(()=>{"use strict";const t="nails/driver-invoice-authorize-net";new class{constructor(){this.params=class{static getParams(t){var e=document.getElementsByTagName("script");for(let i=0;i<e.length;i++)if(e[i].src.indexOf("/"+t)>-1){let t=e[i].src.split("?").pop().split("&"),a={};for(let e=0;e<t.length;e++){let i=t[e].split("=");a[i[0]]=i[1]}return a}return{}}}.getParams("vendor/"+t+"/assets/js/checkout.min.js"),this.hash=this.params.hash,this.clientKey=this.params.key,this.apiLoginId=this.params.loginId,this.prepareForm(),this.bindEvents(),this.registerValidator()}prepareForm(){this.$form=$("#js-invoice-main-form"),this.$panel=$('.js-invoice-panel-payment-details[data-driver="'+t+'"]',this.$form),this.$inputCardName=$(".js-invoice-cc-name",this.$panel),this.$inputCardNum=$(".js-invoice-cc-num",this.$panel),this.$inputCardExp=$(".js-invoice-cc-exp",this.$panel),this.$inputCardCvc=$(".js-invoice-cc-cvc",this.$panel),this.$input=$("<input>").attr("type","hidden").attr("name",this.params.hash+"[token]"),this.$panel.append(this.$input),this.$inputCardName.removeAttr("name"),this.$inputCardNum.removeAttr("name"),this.$inputCardExp.removeAttr("name"),this.$inputCardCvc.removeAttr("name")}bindEvents(){}registerValidator(){this.$form.data("validators").push({slug:t,instance:this})}validate(t){this.getToken().done((()=>{t.resolve()})).fail((e=>{t.reject(e)}))}getToken(){let t=new $.Deferred,e={clientKey:this.clientKey,apiLoginID:this.apiLoginId},i=this.$inputCardExp.val().split("/"),a=$.trim(i[0]);1===a.length&&(a="0"+a);let s=$.trim(i[1]);s.length>2?s=s.slice(-2):1===s.length&&(s="0"+s);let r={authData:e,cardData:{fullName:$.trim(this.$inputCardName.val()),cardNumber:this.$inputCardNum.val().replace(/[^\d]/g,""),month:a,year:s,cardCode:$.trim(this.$inputCardCvc.val())}};return Accept.dispatchData(r,(e=>{if("Error"===e.messages.resultCode){let i=[],a=0;for(;a<e.messages.message.length;)i.push(e.messages.message[a].text),a+=1;t.reject(i.join(" "))}else this.$input.val(JSON.stringify(e.opaqueData)),this.$inputCardName.val(""),this.$inputCardNum.val(""),this.$inputCardExp.val(""),this.$inputCardCvc.val(""),t.resolve()})),t.promise()}}})();